// Minified: Fetch Google cert, extract RSA modulus (n) - 256 bytes
function pemToDer(p){const b=p.replace(/-----BEGIN CERTIFICATE-----/g,"").replace(/-----END CERTIFICATE-----/g,"").replace(/\s+/g,""),n=atob(b),r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}
function readLen(b,o){const l=b[o];if(l<0x80)return{len:l,sz:1};let n=l&0x7f,r=0;for(let i=0;i<n;i++)r=(r<<8)|b[o+1+i];return{len:r,sz:1+n}}
function asn1(b,o=0){const t=b[o++],{len,sz}=readLen(b,o);o+=sz;const e=o+len,c=(t&0x20)!==0,n={t,tc:t>>6,tn:t&0x1f,c,e,v:b.subarray(o,e),s:[]};if(c){let x=o;while(x<e){const ch=asn1(b,x);n.s.push(ch);x=ch.e}}return n}
function strip(b){let i=0;while(i<b.length-1&&b[i]===0)i++;return b.subarray(i)}
function getSPKI(d){const c=asn1(d);const t=c.s[0];let i=0;if(t.s[i]&&t.s[i].tc===2&&t.s[i].tn===0)i++;return t.s[i+5]}
function getN(spki){const bs=spki.s[1].v.subarray(1);const r=asn1(bs);return strip(r.s[0].v)}
function getRSA(pem){return getN(getSPKI(pemToDer(pem)))}
const res=await Functions.makeHttpRequest({url:"https://www.googleapis.com/robot/v1/metadata/x509/securetoken@system.gserviceaccount.com"});
if(res.error)throw Error("Request failed");
const certs=res.data,kid=Object.keys(certs)[0];
if(!kid)throw Error("No certs");
return getRSA(certs[kid]);
